import{r as a,R as j,j as ue,F as se,a as U}from"./app.8f41755a.js";import{C as K,S as W,y as A,T as pe,o as S,c as ie,u as G,p as q,$ as V,d as oe}from"./open-closed.0d489d91.js";import{I as H,n as J,d as ne,L as ce,O as M,T as L,F as ve,N as de,o as D,r as re,e as fe}from"./use-owner.dcb13aec.js";import{s as Pe}from"./use-resolve-button-type.fe2d668c.js";import{E as me,n as le,h as _,a as z,s as N}from"./use-event-listener.cd17cf37.js";var Se=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Se||{}),be=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(be||{});let xe={[0]:e=>({...e,popoverState:G(e.popoverState,{[0]:1,[1]:0})}),[1](e){return e.popoverState===1?e:{...e,popoverState:1}},[2](e,l){return e.button===l.button?e:{...e,button:l.button}},[3](e,l){return e.buttonId===l.buttonId?e:{...e,buttonId:l.buttonId}},[4](e,l){return e.panel===l.panel?e:{...e,panel:l.panel}},[5](e,l){return e.panelId===l.panelId?e:{...e,panelId:l.panelId}}},X=a.exports.createContext(null);X.displayName="PopoverContext";function Q(e){let l=a.exports.useContext(X);if(l===null){let o=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,Q),o}return l}let Y=a.exports.createContext(null);Y.displayName="PopoverAPIContext";function Z(e){let l=a.exports.useContext(Y);if(l===null){let o=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,Z),o}return l}let ee=a.exports.createContext(null);ee.displayName="PopoverGroupContext";function ae(){return a.exports.useContext(ee)}let te=a.exports.createContext(null);te.displayName="PopoverPanelContext";function ye(){return a.exports.useContext(te)}function $e(e,l){return G(l.type,xe,e,l)}let ge="div",Ee=K(function(e,l){var o;let P=`headlessui-popover-button-${H()}`,r=`headlessui-popover-panel-${H()}`,c=a.exports.useRef(null),$=A(l,pe(t=>{c.current=t})),g=a.exports.useReducer($e,{popoverState:1,button:null,buttonId:P,panel:null,panelId:r,beforePanelSentinel:a.exports.createRef(),afterPanelSentinel:a.exports.createRef()}),[{popoverState:d,button:s,panel:n,beforePanelSentinel:B,afterPanelSentinel:h},m]=g,p=J((o=c.current)!=null?o:s);a.exports.useEffect(()=>m({type:3,buttonId:P}),[P,m]),a.exports.useEffect(()=>m({type:5,panelId:r}),[r,m]);let v=a.exports.useMemo(()=>{if(!s||!n)return!1;for(let F of document.querySelectorAll("body > *"))if(Number(F==null?void 0:F.contains(s))^Number(F==null?void 0:F.contains(n)))return!0;let t=ne(),u=t.indexOf(s),f=(u+t.length-1)%t.length,C=(u+1)%t.length,k=t[f],R=t[C];return!n.contains(k)&&!n.contains(R)},[s,n]),b=a.exports.useMemo(()=>({buttonId:P,panelId:r,close:()=>m({type:1})}),[P,r,m]),x=ae(),E=x==null?void 0:x.registerPopover,w=S(()=>{var t;return(t=x==null?void 0:x.isFocusWithinPopoverGroup())!=null?t:(p==null?void 0:p.activeElement)&&((s==null?void 0:s.contains(p.activeElement))||(n==null?void 0:n.contains(p.activeElement)))});a.exports.useEffect(()=>E==null?void 0:E(b),[E,b]),me(p==null?void 0:p.defaultView,"focus",t=>{var u,f,C,k;d===0&&(w()||!s||!n||(f=(u=B.current)==null?void 0:u.contains)!=null&&f.call(u,t.target)||(k=(C=h.current)==null?void 0:C.contains)!=null&&k.call(C,t.target)||m({type:1}))},!0),ce([s,n],(t,u)=>{m({type:1}),ve(u,de.Loose)||(t.preventDefault(),s==null||s.focus())},d===0);let T=S(t=>{m({type:1});let u=(()=>t?t instanceof HTMLElement?t:"current"in t&&t.current instanceof HTMLElement?t.current:s:s)();u==null||u.focus()}),i=a.exports.useMemo(()=>({close:T,isPortalled:v}),[T,v]),I=a.exports.useMemo(()=>({open:d===0,close:T}),[d,T]),y=e,O={ref:$};return j.createElement(X.Provider,{value:g},j.createElement(Y.Provider,{value:i},j.createElement(ie,{value:G(d,{[0]:q.Open,[1]:q.Closed})},V({ourProps:O,theirProps:y,slot:I,defaultTag:ge,name:"Popover"}))))}),Ie="button",he=K(function(e,l){let[o,P]=Q("Popover.Button"),{isPortalled:r}=Z("Popover.Button"),c=a.exports.useRef(null),$=`headlessui-focus-sentinel-${H()}`,g=ae(),d=g==null?void 0:g.closeOthers,s=ye(),n=s===null?!1:s===o.panelId,B=A(c,l,n?null:t=>t&&P({type:2,button:t})),h=A(c,l),m=J(c),p=S(t=>{var u,f,C;if(n){if(o.popoverState===1)return;switch(t.key){case D.Space:case D.Enter:t.preventDefault(),(f=(u=t.target).click)==null||f.call(u),P({type:1}),(C=o.button)==null||C.focus();break}}else switch(t.key){case D.Space:case D.Enter:t.preventDefault(),t.stopPropagation(),o.popoverState===1&&(d==null||d(o.buttonId)),P({type:0});break;case D.Escape:if(o.popoverState!==0)return d==null?void 0:d(o.buttonId);if(!c.current||(m==null?void 0:m.activeElement)&&!c.current.contains(m.activeElement))return;t.preventDefault(),t.stopPropagation(),P({type:1});break}}),v=S(t=>{n||t.key===D.Space&&t.preventDefault()}),b=S(t=>{var u,f;re(t.currentTarget)||e.disabled||(n?(P({type:1}),(u=o.button)==null||u.focus()):(t.preventDefault(),t.stopPropagation(),o.popoverState===1&&(d==null||d(o.buttonId)),P({type:0}),(f=o.button)==null||f.focus()))}),x=S(t=>{t.preventDefault(),t.stopPropagation()}),E=o.popoverState===0,w=a.exports.useMemo(()=>({open:E}),[E]),T=Pe(e,c),i=e,I=n?{ref:h,type:T,onKeyDown:p,onClick:b}:{ref:B,id:o.buttonId,type:T,"aria-expanded":e.disabled?void 0:o.popoverState===0,"aria-controls":o.panel?o.panelId:void 0,onKeyDown:p,onKeyUp:v,onClick:b,onMouseDown:x},y=le(),O=S(()=>{let t=o.panel;if(!t)return;function u(){G(y.current,{[N.Forwards]:()=>M(t,L.First),[N.Backwards]:()=>M(t,L.Last)})}u()});return ue(se,{children:[V({ourProps:I,theirProps:i,slot:w,defaultTag:Ie,name:"Popover.Button"}),E&&!n&&r&&U(_,{id:$,features:z.Focusable,as:"button",type:"button",onFocus:O})]})}),Ce="div",Te=W.RenderStrategy|W.Static,Oe=K(function(e,l){let[{popoverState:o},P]=Q("Popover.Overlay"),r=A(l),c=`headlessui-popover-overlay-${H()}`,$=oe(),g=(()=>$!==null?$===q.Open:o===0)(),d=S(n=>{if(re(n.currentTarget))return n.preventDefault();P({type:1})}),s=a.exports.useMemo(()=>({open:o===0}),[o]);return V({ourProps:{ref:r,id:c,"aria-hidden":!0,onClick:d},theirProps:e,slot:s,defaultTag:Ce,features:Te,visible:g,name:"Popover.Overlay"})}),ke="div",we=W.RenderStrategy|W.Static,Be=K(function(e,l){let{focus:o=!1,...P}=e,[r,c]=Q("Popover.Panel"),{close:$,isPortalled:g}=Z("Popover.Panel"),d=`headlessui-focus-sentinel-before-${H()}`,s=`headlessui-focus-sentinel-after-${H()}`,n=a.exports.useRef(null),B=A(n,l,i=>{c({type:4,panel:i})}),h=J(n),m=oe(),p=(()=>m!==null?m===q.Open:r.popoverState===0)(),v=S(i=>{var I;switch(i.key){case D.Escape:if(r.popoverState!==0||!n.current||(h==null?void 0:h.activeElement)&&!n.current.contains(h.activeElement))return;i.preventDefault(),i.stopPropagation(),c({type:1}),(I=r.button)==null||I.focus();break}});a.exports.useEffect(()=>{var i;e.static||r.popoverState===1&&((i=e.unmount)!=null?i:!0)&&c({type:4,panel:null})},[r.popoverState,e.unmount,e.static,c]),a.exports.useEffect(()=>{if(!o||r.popoverState!==0||!n.current)return;let i=h==null?void 0:h.activeElement;n.current.contains(i)||M(n.current,L.First)},[o,n,r.popoverState]);let b=a.exports.useMemo(()=>({open:r.popoverState===0,close:$}),[r,$]),x={ref:B,id:r.panelId,onKeyDown:v,onBlur:o&&r.popoverState===0?i=>{var I,y,O,t,u;let f=i.relatedTarget;!f||!n.current||(I=n.current)!=null&&I.contains(f)||(c({type:1}),(((O=(y=r.beforePanelSentinel.current)==null?void 0:y.contains)==null?void 0:O.call(y,f))||((u=(t=r.afterPanelSentinel.current)==null?void 0:t.contains)==null?void 0:u.call(t,f)))&&f.focus({preventScroll:!0}))}:void 0,tabIndex:-1},E=le(),w=S(()=>{let i=n.current;if(!i)return;function I(){G(E.current,{[N.Forwards]:()=>{M(i,L.First)},[N.Backwards]:()=>{var y;(y=r.button)==null||y.focus({preventScroll:!0})}})}I()}),T=S(()=>{let i=n.current;if(!i)return;function I(){G(E.current,{[N.Forwards]:()=>{var y,O,t;if(!r.button)return;let u=ne(),f=u.indexOf(r.button),C=u.slice(0,f+1),k=[...u.slice(f+1),...C];for(let R of k.slice())if(((O=(y=R==null?void 0:R.id)==null?void 0:y.startsWith)==null?void 0:O.call(y,"headlessui-focus-sentinel-"))||((t=r.panel)==null?void 0:t.contains(R))){let F=k.indexOf(R);F!==-1&&k.splice(F,1)}M(k,L.First,!1)},[N.Backwards]:()=>M(i,L.Last)})}I()});return j.createElement(te.Provider,{value:r.panelId},p&&g&&U(_,{id:d,ref:r.beforePanelSentinel,features:z.Focusable,as:"button",type:"button",onFocus:w}),V({ourProps:x,theirProps:P,slot:b,defaultTag:ke,features:we,visible:p,name:"Popover.Panel"}),p&&g&&U(_,{id:s,ref:r.afterPanelSentinel,features:z.Focusable,as:"button",type:"button",onFocus:T}))}),Fe="div",De=K(function(e,l){let o=a.exports.useRef(null),P=A(o,l),[r,c]=a.exports.useState([]),$=S(p=>{c(v=>{let b=v.indexOf(p);if(b!==-1){let x=v.slice();return x.splice(b,1),x}return v})}),g=S(p=>(c(v=>[...v,p]),()=>$(p))),d=S(()=>{var p;let v=fe(o);if(!v)return!1;let b=v.activeElement;return(p=o.current)!=null&&p.contains(b)?!0:r.some(x=>{var E,w;return((E=v.getElementById(x.buttonId))==null?void 0:E.contains(b))||((w=v.getElementById(x.panelId))==null?void 0:w.contains(b))})}),s=S(p=>{for(let v of r)v.buttonId!==p&&v.close()}),n=a.exports.useMemo(()=>({registerPopover:g,unregisterPopover:$,isFocusWithinPopoverGroup:d,closeOthers:s}),[g,$,d,s]),B=a.exports.useMemo(()=>({}),[]),h=e,m={ref:P};return j.createElement(ee.Provider,{value:n},V({ourProps:m,theirProps:h,slot:B,defaultTag:Fe,name:"Popover.Group"}))}),Ge=Object.assign(Ee,{Button:he,Overlay:Oe,Panel:Be,Group:De});export{Ge as m};
