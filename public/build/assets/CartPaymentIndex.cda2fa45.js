import L from"./FrontendContainer.f87df6a5.js";import S from"./FrontendContentContainer.e2e5b70a.js";import B from"./CartStepper.0e2a0f63.js";import F from"./OrderSummary.7075809a.js";import{e as P,r as l,A,h as u,l as i,b as D,u as E,x as y,v as G,a4 as I,a as t,j as p,L as O,s as U,a5 as W}from"./app.8f41755a.js";import z from"./ConfirmationModal.8e17e7a9.js";import"./index.74c4741c.js";import"./MainNav.20d61781.js";import"./index.esm.968e8465.js";import"./index.esm.c2914463.js";import"./helpers.b999fcd4.js";import"./SearchField.46d947e0.js";import"./pluralize.a87e66d1.js";import"./MainNavBookCategoriesList.378062f1.js";import"./popover.4efe15a7.js";import"./open-closed.0d489d91.js";import"./use-owner.dcb13aec.js";import"./use-resolve-button-type.fe2d668c.js";import"./use-event-listener.cd17cf37.js";import"./motion.5c4d7eb2.js";import"./CartIndexOrderSummary.222fd040.js";import"./lib.3666cbba.js";import"./NoElements.fe12762f.js";import"./tabs.59b69d47.js";import"./transition.a7dac45d.js";import"./dialog.d76c2d8b.js";import"./menu.b1c0e94d.js";import"./MetaElement.15b324ae.js";/* empty css                   */import"./SystemMessage.0606d8b1.js";import"./FrontendBreadCrumbs.bfadd15b.js";import"./AlertMessage.0840591f.js";import"./index.62a2be08.js";function Ne({order:s,settings:o,auth:d}){const{cart:n,locale:g,confirmationModal:C}=P(e=>e),{trans:r,classNames:v,getAsset:N,mainColor:h,mainBgColor:x,textColor:M,contentBgColor:k,btnClass:_}=l.exports.useContext(A),b=[{id:1,name:o.payment_method,paymentRoute:u(`${o.payment_method}.api.payment.create`),enabled:o.enable_payment_online},{id:2,name:"paypal",paymentRoute:u("paypal.api.payment.create"),enabled:o.enable_payment_online&&o.enable_books},{id:3,name:"cash_on_delivery",paymentRoute:u("frontend.cart.cod.payment"),enabled:o.cash_on_delivery&&n.shipmentCountry.is_local}],[a,T]=l.exports.useState(i.exports.first(i.exports.map(b,e=>e.enabled))),[j,c]=l.exports.useState(""),[w,m]=l.exports.useState(!0),f=D();E({netTotal:n.netTotal,paymentMethod:a.name}),l.exports.useMemo(()=>{if(a.name==="paypal")return y.post(a.paymentRoute,{netTotal:n.netTotal,order_id:s.id,paymentMethod:a.name}).then(e=>c(e.data)).catch(e=>console.log("the e ===>",e.response.data)).finally(()=>m(!1));if(a.name==="tap")return y.post(a.paymentRoute,{netTotal:n.netTotal,order_id:s.id,paymentMethod:a.name}).then(e=>c(e.data)).catch(e=>console.log("e",e.response.data)).finally(()=>m(!1));if(a.name==="myfatoorahv2")return y.post(a.paymentRoute,{netTotal:n.netTotal,order_id:s.id,paymentMethod:a.name}).then(e=>c(e.data)).catch(e=>console.log("e",e.response.data)).finally(()=>m(!1));if(a.name==="oneglobal")return y.post(a.paymentRoute,{netTotal:n.netTotal,order_id:s.id,paymentMethod:a.name}).then(e=>c(e.data)).catch(e=>console.log("e",e.response.data)).finally(()=>m(!1));if(a.name==="cash_on_delivery")return f(G({type:"",model:"",id:s.id,title:`${r("confirm")}`,message:`${r("r_u_sure_u_order_cash_on_delivery")}`}))},[a]);const $=e=>{T(e),m(!0)},R=()=>{f(w?U({message:r("no_payment_method_selected"),type:"error"}):W())};return l.exports.useEffect(()=>{f(I({multiCartMerchant:o.multi_cart_merchant,applyGlobalShipment:o.apply_global_shipment,shipmentCountry:d&&d.country&&i.exports.isEmpty(n.shipmentCountry)?d.country:n.shipmentCountry,shipmentFees:o.apply_global_shipment?o.shipment_fixed_rate:n.shipmentFees}))},[]),t(L,{children:t(S,{children:p("div",{className:`${M} ${k} w-full mx-auto py-5 px-4 sm:px-6 lg:px-8 `,children:[t(B,{activeStep:4}),t("h1",{className:"text-3xl font-extrabold py-5 ",children:r("payment_process")}),t(F,{}),o.enable_payment_online?p("div",{className:"flex flex-col flex-1 justify-between items-start px-8 py-6 sm:p-6 lg:p-8 border-t border-gray-50",children:[t("h1",{className:"text-3xl font-extrabold py-5 ",children:r("choose_payment_method")}),t("div",{className:"flex w-full flex-row flex-wrap md:flex-nowrap justify-between items-center gap-x-5 gap-y-5 rounded-lg py-6",children:i.exports.map(i.exports.filter(b,e=>e.enabled),e=>p("button",{onClick:()=>$(e),className:v(e.name===a.name?`bg-${x}-200 text-${h}-900 dark:bg-${x}-400 dark:text-${h}-50 border-gray-400 shadow-lg`:"border-gray-100 shadow-sm","flex flex-row w-full max-w-md justify-center items-center p-10 border-2 rounded-lg gap-x-4"),children:[t("img",{src:N(e.name),alt:"",className:"w-auto h-10"}),t("span",{className:"font-extrabold text-lg invisible sm:visible",children:r(e.name)})]},e.name))})]}):null,o.cash_on_delivery&&o.enable_products&&t(z,{confirmationOpen:C.display,message:r("r_u_sure_u_order_cash_on_delivery"),routeName:"frontend.cart.cod.payment",paramId:s.id}),p("div",{className:"mt-10 col-span-full flex justify-between items-center flex-wrap space-y-2 sm:space-y-0 w-full",children:[p(O,{href:u("frontend.cart.confirmation",{email:d.email,country_id:n.shipmentCountry.id}),className:`${_} flex flex-row justify-between items-center border border-transparent rounded-md shadow-sm py-3 px-4  text-base font-medium  focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-gray-500`,children:[t("div",{className:"flex",children:g.isRTL?t("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}):t("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),t("span",{className:"flex ",children:r("previous")})]}),o.enable_payment_online?t("div",{className:"flex",children:t("a",{onClick:()=>R(),href:w?"#":j,className:`disabled ${_} capitalize flex flex-row w-full sm:w-auto justify-between items-center  border border-transparent rounded-md shadow-sm py-3 px-4 space-y-5 text-base font-medium  focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-gray-500`,children:r("go_to_payment_page")})}):null]})]})})})}export{Ne as default};
